package main

const tpl = `
// Code generated by protoc-gen-golug. DO NOT EDIT.
{%- if !fd.GetOptions().GetDeprecated() %}
// source: {{fd.GetName()}}
{%- else %}
// {{fd.GetName()}} is a deprecated file.
{%- endif %}

package {{pkg}}
import (
	"reflect"

	"github.com/pubgo/golug/golug_xgen"
	"github.com/pubgo/golug/golug_client/grpclient"
)

{% for ss in fd.GetService() %}
	func init() {
		var mthList []golug_xgen.GrpcRestHandler
		{%- for m in ss.GetMethod() %}
			mthList = append(mthList, golug_xgen.GrpcRestHandler{
				Name:         "{{m.GetName()}}",
				Method:       "{{m.HttpMethod}}",
				Path:          "{{m.HttpPath}}",
				ClientStream:  "{{m.CS}}"=="True",
				ServerStreams: "{{m.SS}}"=="True",
			})
		{% endfor %}
		golug_xgen.Add(reflect.ValueOf(Register{{ss.Srv}}Server),mthList)
	}
{% endfor %}


{% for ss in fd.GetService() %}
	func Init{{ss.Srv}}Client(srv string) {{ss.Srv}}Client {
		return &{{unExport(ss.Srv)}}Client{grpclient.Init(srv)}
	}
{% endfor %}`
